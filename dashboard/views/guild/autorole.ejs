<%- include ("../parts/sidebarguild",{bot,user}) %>

<br>
  <br>
  <div class="container">
<div class="container contact-form">
<div class="contact-image">
      <i></i>
  </div>

  
  <form method="POST" action="/dashboard/guild/<%=guild.id%>/autorole" >
  
      
     <div class="row">
         <div class="col-md-6">
            
      <br><br>      
      <br/>
   
      
    
       <br>
     <div class="form-group">
       <label><h5 class="text-break">AUTOROLE</h5></label>
  <br>
       <br>
  
  
     <input type="radio" class="form-check-input" name="roleOn" value="true"  id="roleonoff" checked>  

    
       <input type="radio" class="form-check-input" name="roleOn" value="false"   id="roleonoff">
    
           </div>
           <br>
    
                           <label>
  <input id="myCheckBox" type="checkbox" checked/> Toggle me
</label>
      
    <div class="form-group" id="hama">
          <label>CHOSE ROLE</label>
             <select class="form-control"  id="role">
           <% if(data.plugins.autorole.enabled && guild.roles.cache.has(data.plugins.autorole.role)){ %>
               <option selected="selected">@<%= guild.roles.cache.get(data.plugins.autorole.role).name %></option>
  <% guild.roles.cache.filter((r) => r.id !== data.plugins.autorole.role && r.name !== "@everyone").forEach((r) => { %>
               <option>@<%= r.name %></option>
              <% }); } else { %>
  <option selected="selected">@<%= guild.roles.cache.filter((r) => r.name !== "@everyone").first().name %></option>
<% guild.roles.cache.filter((r) => r.id !== guild.roles.cache.filter((r) => r.name !== "@everyone").first().id && r.name !== "@everyone").forEach((r) => { %>
                          <option value="<%= r.id %>">@<%= r.name %></option>
                            <% }); %>
                           <% } %>
                        </select>
                   
                      </div>
                        
     
     <br>
                            <br>
                            
      
               <button type="submit" name="roleEnable"  id="myButton" onclick="clickAdd()"class="btn btn-primary"><i class="fal fa-paper-plane"></i> Apply</button>
    </div>
             </div>
  </form>
  
    
</div>
  
             </div>
<br><br>
  
  
      <script>
      
        $('#hama').hide
        
        
        
       document.addEventListener('DOMContentLoaded', function () {
  var checkbox = document.querySelector('input[type="checkbox"]');

  checkbox.addEventListener('change', function () {
    if (checkbox.checked) {
    
      
      $.post("/dashboard/guild/<%=guild.id%>/autorole",{
        onoff:true,
        role:$('#role').val(),
  
      })
      
      // do this
      console.log('Checked');
    } else {
      $.post("/dashboard/guild/<%=guild.id%>/autorole",{
        
      
        
      })
      // do that
      console.log('Not checked');
    }
  });
}); 
        
        
        
        
        
        
        
      function clickAdd() {
       
        

$("#myButton").attr("disabled", true);
 $("#myButton").html('<i class="p-2 fad fa-spinner fa-w-16 fa-pulse fa-lg"></i>');

    setTimeout(() => {
      
        $.post('/dashboard/guild/<%=guild.id%>/autorole',{
          onoff:$('#roleonoff').val(),
          role:$('#role').val()
          
        }).done(function(data){
        
                
                
                
                
                if(data.error){
      const Toast = Swal.mixin({
  toast: true,
  position: 'top-end',
  showConfirmButton: false,
  timer: 4000,
  timerProgressBar: true,
  didOpen: (toast) => {
    toast.addEventListener('mouseleave', Swal.stopTimer)
    toast.addEventListener('mouseleave', Swal.resumeTimer)
    }})
    
Toast.fire({
  icon: 'error',
  title: 'we have problem',
  text: data.message,
  footer: `<%=guild.name%>` + '<br>' + 'BoBo Dashboard',
  
})
  $("#myButton").html('<i class="fal fa-paper-plane"></i>&nbsp;Submit');
                    $("#myButton").attr("disabled", false);
                    return;    
      
    
    
    
    }else{
     
  
      const Toast = Swal.mixin({
  toast: true,
  position: 'top-end',
  showConfirmButton: false,
  timer: 3000,
  timerProgressBar: true,
  didOpen: (toast) => {
    toast.addEventListener('mouseenter', Swal.stopTimer)
    toast.addEventListener('mouseleave', Swal.resumeTimer)
  }
})

      
  Toast.fire({
  icon: 'success',
  title: 'successful...',
  text:data.message,
  footer:`<%=guild.name%>` + 'BoBo Dashboard',
    
  })

            $("#myButton").html('<i class="fal fa-paper-plane"></i>&nbsp;Submit');
                    $("#myButton").attr("disabled", false);
                    return;
                      
      
      
    
    }});
     },900)

    }
        
        
        
        

   </script>
<%- include("../parts/foot.ejs")%>